################################################################################
# GKE Cluster Configuration - Development Standard with Spot VMs
#
# This configuration creates a cost-optimized development cluster using Spot VMs
# Spot VMs are up to 91% cheaper than standard VMs but can be preempted.
# Ideal for: development, testing, batch jobs, fault-tolerant workloads
#
# Usage:
#   ./create-gke-cluster.sh cluster-envs/dev-spot-zonal.env
#
################################################################################

# ============================================================================
# REQUIRED CONFIGURATION
# ============================================================================

# GCP Project ID where the cluster will be created
PROJECT_ID="hcm-hyperfleet"

# Name of the GKE cluster
CLUSTER_NAME="hyperfleet-dev-spot"

# Region for the cluster (e.g., us-central1, europe-west1)
REGION="us-central1"

# Cluster mode: autopilot or standard
# - autopilot: Recommended. Fully managed, auto-scaled nodes
# - standard:  More control over node configuration
CLUSTER_MODE="standard"

# Network mode: create or existing
# - create:   Create new VPC network and subnet
# - existing: Use existing VPC network and subnet
NETWORK_MODE="create"

# VPC network name
NETWORK_NAME="hyperfleet-dev-spot-vpc"

# Subnet name
SUBNET_NAME="hyperfleet-dev-spot-subnet"

# ============================================================================
# OPTIONAL CONFIGURATION - Network Settings
# ============================================================================

# Subnet IP range (CIDR notation) - only when NETWORK_MODE=create
SUBNET_RANGE="10.3.0.0/16"

# SSH access source IP ranges - only when NETWORK_MODE=create
# Note: 0.0.0.0/0 allows all sources (restrict in production!)
SSH_SOURCE_RANGES="0.0.0.0/0"

# ============================================================================
# OPTIONAL CONFIGURATION - Standard Mode Settings
# ============================================================================

# [STANDARD] Deployment type
# - zonal:    Single zone (dev/test environments)
# - regional: Multi-zone (recommended for production)
DEPLOYMENT_TYPE="zonal"

# [STANDARD] Specific zone for zonal deployments
ZONE="${REGION}-a"

# [STANDARD] Number of nodes per zone
# For regional: nodes PER ZONE (3 zones = 3x this number)
# For zonal: total nodes
NUM_NODES="1"

# [STANDARD] Machine type for cluster nodes
MACHINE_TYPE="e2-standard-4"

# [STANDARD] Boot disk size for nodes (in GB)
DISK_SIZE="100"

# [STANDARD] Autoscaling - leave empty to disable
MIN_NODES="1"
MAX_NODES="10"

# [STANDARD] Use Spot VMs (formerly preemptible VMs)
# - true:  Use Spot VMs (up to 91% cheaper, can be preempted)
# - false: Use standard VMs (default, guaranteed availability)
# Note: Spot VMs are ideal for fault-tolerant workloads, batch jobs
USE_SPOT_VMS="true"

# ============================================================================
# OPTIONAL CONFIGURATION - Version and Release Channel
# ============================================================================

# GKE release channel: rapid | regular | stable
RELEASE_CHANNEL="regular"

# Specific cluster version - only used if RELEASE_CHANNEL is empty
CLUSTER_VERSION=""

# ============================================================================
# OPTIONAL CONFIGURATION - Config Connector
# ============================================================================

# Config Connector Google Service Account name
# Full email will be: CONFIG_CONNECTOR_SA@PROJECT_ID.iam.gserviceaccount.com
CONFIG_CONNECTOR_SA="hyperfleet-config-connector"

# ============================================================================
# OPTIONAL CONFIGURATION - Labels
# ============================================================================

# Cluster labels (comma-separated key=value pairs)
# Example: environment=dev,team=platform
LABELS="environment=dev,vm-type=spot,cost-optimized=true"

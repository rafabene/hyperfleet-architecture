# ============================================================================
# HyperFleet Adapter Observability Configuration Template (Minimal)
# ============================================================================
#
# Minimal observability configuration for HyperFleet adapters.
# Contains only essential settings for logging, metrics, and health checks.
#
# Usage:
# 1. Copy for each environment: adapter-observability-{dev|staging|prod}.yaml
# 2. Update values for that environment
# 3. Deploy: kubectl apply -f adapter-observability-dev.yaml
# 4. Adapters reference via: envFrom.configMapRef.name: adapter-observability
# ============================================================================

---
# Development Environment
apiVersion: v1
kind: ConfigMap
metadata:
  name: adapter-observability
  namespace: hyperfleet-system
  labels:
    app.kubernetes.io/name: hyperfleet
    app.kubernetes.io/component: observability-config
    hyperfleet.io/environment: development
data:
  # Logging
  LOG_LEVEL: "debug"
  LOG_FORMAT: "json"
  
  # Metrics (Prometheus)
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"
  
  # Health Checks
  HEALTH_ENABLED: "true"
  HEALTH_PORT: "8080"
  HEALTH_LIVENESS_PATH: "/healthz"
  HEALTH_READINESS_PATH: "/readyz"
  
  # Tracing (OpenTelemetry)
  TRACE_ENABLED: "true"
  TRACE_ENDPOINT: "http://otel-collector.observability.svc.cluster.local:4317"
  TRACE_SAMPLE_RATE: "1.0"

---
# Staging Environment
apiVersion: v1
kind: ConfigMap
metadata:
  name: adapter-observability
  namespace: hyperfleet-system
  labels:
    app.kubernetes.io/name: hyperfleet
    app.kubernetes.io/component: observability-config
    hyperfleet.io/environment: staging
data:
  # Logging
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  
  # Metrics (Prometheus)
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"
  
  # Health Checks
  HEALTH_ENABLED: "true"
  HEALTH_PORT: "8080"
  HEALTH_LIVENESS_PATH: "/healthz"
  HEALTH_READINESS_PATH: "/readyz"
  
  # Tracing (OpenTelemetry)
  TRACE_ENABLED: "true"
  TRACE_ENDPOINT: "http://otel-collector.observability.svc.cluster.local:4317"
  TRACE_SAMPLE_RATE: "0.5"

---
# Production Environment
apiVersion: v1
kind: ConfigMap
metadata:
  name: adapter-observability
  namespace: hyperfleet-system
  labels:
    app.kubernetes.io/name: hyperfleet
    app.kubernetes.io/component: observability-config
    hyperfleet.io/environment: production
data:
  # Logging
  LOG_LEVEL: "warn"
  LOG_FORMAT: "json"
  
  # Metrics (Prometheus)
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"
  
  # Health Checks
  HEALTH_ENABLED: "true"
  HEALTH_PORT: "8080"
  HEALTH_LIVENESS_PATH: "/healthz"
  HEALTH_READINESS_PATH: "/readyz"
  
  # Tracing (OpenTelemetry)
  TRACE_ENABLED: "true"
  TRACE_ENDPOINT: "http://otel-collector.observability.svc.cluster.local:4317"
  TRACE_SAMPLE_RATE: "0.1"

---
# ============================================================================
# Usage in Adapter Deployment
# ============================================================================
#
# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: validation-adapter
#   namespace: hyperfleet-system
# spec:
#   template:
#     spec:
#       containers:
#         - name: adapter
#           image: validation-adapter:latest
#           ports:
#             - name: metrics
#               containerPort: 9090
#             - name: health
#               containerPort: 8080
#           
#           envFrom:
#             - configMapRef:
#                 name: adapter-observability
#             - configMapRef:
#                 name: hyperfleet-environment
#             - configMapRef:
#                 name: hyperfleet-broker-config
#           
#           livenessProbe:
#             httpGet:
#               path: /healthz
#               port: 8080
#             initialDelaySeconds: 15
#             periodSeconds: 15
#           
#           readinessProbe:
#             httpGet:
#               path: /readyz
#               port: 8080
#             initialDelaySeconds: 10
#             periodSeconds: 10
#
# ---
# apiVersion: v1
# kind: Service
# metadata:
#   name: validation-adapter-metrics
#   namespace: hyperfleet-system
#   annotations:
#     prometheus.io/scrape: "true"
#     prometheus.io/port: "9090"
#     prometheus.io/path: "/metrics"
# spec:
#   selector:
#     app.kubernetes.io/name: validation-adapter
#   ports:
#     - name: metrics
#       port: 9090
#       targetPort: 9090
# ============================================================================
